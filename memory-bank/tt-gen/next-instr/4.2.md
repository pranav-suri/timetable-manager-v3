# Next Step Instructions: Step 5.1 - Create Generation UI Component

**For**: Next Agent
**Created**: 2025-10-30
**Previous Step**: 4.2 - Implement Timetable Validation and Quality Metrics

## Context: What Was Just Completed

Phase 4 is now complete. We have a fully functional backend for timetable generation. The system can asynchronously run the GA, track job progress, persist the final `LectureSlot` results to the database, and generate a detailed quality report. The `generateRouter.ts` tRPC router exposes endpoints to `start`, `cancel`, and check the `status` of generation jobs. The backend is ready to be connected to a user interface.

## What Step 5.1 Needs to Accomplish

This is a major step that transitions from backend logic to frontend UI development. The goal is to build the user interface that allows an administrator to manage the timetable generation process. This will involve creating several new React components and a new route.

### Core Objectives

1.  **Create a New Route**: A new page should be created at `src/routes/tt/$timetableId/generate.tsx`. This page will be the main dashboard for all generation-related activities for a specific timetable.
2.  **Generation Controls Component**: Build a component (`GenerationControls.tsx`) that allows the user to:
    - Start a new generation job.
    - Select a configuration preset (Fast, Balanced, Thorough).
    - (Optional) View and override advanced configuration options.
3.  **Jobs List Component**: Build a component (`JobsList.tsx`) that lists all past and current generation jobs for the timetable. It should display the status, progress, and creation date of each job. This will use the `list` query from the `generateRouter`.
4.  **Job Status Component**: For jobs that are `PENDING` or `IN_PROGRESS`, this component should display the live progress bar and status. It should use the `status` query and the existing `useJobs` hook for polling.
5.  **Results Display**: When a job is `COMPLETED`, there should be a way to view the results. This includes displaying the quality report metrics and providing a link to view the generated timetable itself.

## Implementation Strategy

1.  **Create the Route**: Use TanStack Router to create the new file-based route at `src/routes/tt/$timetableId/generate.tsx`.
2.  **Use Existing Hooks**: The `useJobs.tsx` hook should be the primary tool for interacting with the backend. You will use the mutations and queries it provides to start jobs and get status updates.
3.  **Component-Based Architecture**: Break the UI down into smaller, manageable components as described above (`GenerationControls`, `JobsList`, etc.).
4.  **Material-UI v7**: All new components should be built using the Material-UI v7 library to maintain visual consistency with the rest of the application.
5.  **State Management**: Use Zustand or component state for managing UI-specific state (e.g., which job is selected, whether the advanced options are open).

## Gotchas & Important Considerations

- **Polling**: The `useJobs` hook likely uses polling. Be mindful of the polling interval and the potential for unnecessary network requests.
- **User Feedback**: This is a long-running background process. It is critical to provide clear and constant feedback to the user about what is happening. Use loading spinners, progress bars, and status text liberally.
- **Error Handling**: When a job fails, the UI should clearly display the error message from the `Job` record.
- **Data Display**: The `result` field from the job status query will contain the fitness and quality report data. You will need to render this JSON data in a user-friendly way.
